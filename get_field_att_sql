WITH schemas AS (
    SELECT SCHEMA_NAME
    FROM INFORMATION_SCHEMA.SCHEMATA
    WHERE DATABASE_NAME = 'INGESTION_DB' AND SCHEMA_NAME LIKE 'EC%'
),
field_tables AS (
    SELECT TABLE_SCHEMA, COLUMN_NAME, DATA_TYPE
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = 'FIELD'
)
SELECT 
    s.SCHEMA_NAME,
    (
        SELECT OBJECT_AGG(COLUMN_NAME, DATA_TYPE)
        FROM field_tables f
        WHERE f.TABLE_SCHEMA = s.SCHEMA_NAME
    ) AS FIELD_TABLE_COMPARISON
FROM 
    schemas s;
