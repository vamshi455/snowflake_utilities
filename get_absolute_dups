-- Step 1: Declare a variable to store the column names
SET column_list = (
    SELECT LISTAGG(COLUMN_NAME, ', ') WITHIN GROUP (ORDER BY ORDINAL_POSITION)
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_SCHEMA = 'YOUR_SCHEMA'
    AND TABLE_NAME = 'YOUR_TABLE_NAME'
);

-- Step 2: Use the variable in the dynamic SQL query
EXECUTE IMMEDIATE '
    SELECT *
    FROM (
        SELECT *,
               COUNT(*) OVER (PARTITION BY ' || column_list || ') AS duplicate_count
        FROM YOUR_TABLE_NAME
    ) AS subquery
    WHERE duplicate_count > 1';
